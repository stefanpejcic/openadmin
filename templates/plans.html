<!-- plans.html -->
{% extends 'base.html' %} {% block content %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" integrity="sha384-tViUnnbYAV00FLIhhi3v/dWt3Jxw4gZQcNoSCxCIFNJVCx7/D55/wXsrNIRANwdD" crossorigin="anonymous">

<div x-data="plansTable()" x-init="init()" x-cloak>
    <div x-data="{ showSection: false }" class="border-b border-gray-200 bg-gray-50 p-4 dark:border-gray-800 dark:bg-gray-950 sm:p-6 lg:p-8">
        <header>
            <div class="flex flex-col gap-2 text-center sm:flex-row sm:items-center sm:justify-between sm:text-start">
                <div class="grow">
                    <h1 class="mb-1 text-xl font-bold">User Packages</h1>
                    <h2 class="text-sm font-medium text-slate-500">Create and manage packages for OpenPanel users.</h2>
                </div>
                <div class="flex flex-none items-center justify-center gap-2 rounded-sm px-2 sm:justify-end sm:bg-transparent sm:px-0">
                    <a
                        href="/plans/new"
                        class="relative inline-flex items-center justify-center rounded-md border px-3 py-2 text-center text-sm font-medium shadow-sm transition-all duration-100 ease-in-out cursor-pointer outline outline-offset-2 outline-0 focus-visible:outline-2 outline-blue-500 dark:outline-blue-500 dark:border-gray-800 dark:text-gray-50 dark:bg-gray-950 dark:hover:bg-gray-900/60 disabled:text-gray-400 disabled:dark:text-gray-600 sm:w-fit border-black bg-black text-white hover:bg-gray-800 sm:mt-0"
                    >
                        Create New
                    </a>
                </div>
            </div>
        </header>
    </div>

    <div class="">
        <div class="space-y-3">
            <div class="flex px-6 pt-3 flex-wrap items-center justify-between gap-2 sm:gap-x-6">
                <div class="flex w-full flex-col gap-2 sm:w-fit sm:flex-row sm:items-center">
                    <div class="relative w-full sm:max-w-[250px] sm:[&amp;>input]:h-[30px]">
    <input x-model="searchQuery"  class="relative block w-full appearance-none rounded-md border px-2.5 py-1.5 outline-none transition sm:text-sm border-transparent dark:border-gray-800 text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 bg-gray-100 dark:bg-gray-950 disabled:border-gray-300 disabled:bg-gray-100 disabled:text-gray-400 disabled:dark:border-gray-700 disabled:dark:bg-gray-800 disabled:dark:text-gray-500 focus:ring-2 focus:ring-indigo-200 focus:dark:ring-indigo-700/30 focus:border-indigo-500 focus:dark:border-indigo-700 [&amp;::--webkit-search-cancel-button]:hidden [&amp;::-webkit-search-cancel-button]:hidden [&amp;::-webkit-search-decoration]:hidden pl-8" placeholder="Search by plan name..." type="search" @input="searchQuery =  $event.target.value.trim()">

                        <div class="pointer-events-none absolute bottom-0 left-2 flex h-full items-center justify-center text-gray-400 dark:text-gray-600">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" aria-hidden="true" class="remixicon size-[1.125rem] shrink-0">
                                <path
                                    d="M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.124 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20 13.124 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748Z"
                                ></path>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-2">

        <!-- Dropdown for Column Visibility -->
        <div class="relative">
            <button id="dropdownToggleButton" data-dropdown-toggle="dropdownToggle" class="relative items-center justify-center whitespace-nowrap rounded-md border text-center font-medium shadow-sm transition-all duration-100 ease-in-out disabled:pointer-events-none disabled:shadow-none outline outline-offset-2 outline-0 focus-visible:outline-2 outline-indigo-500 dark:outline-indigo-500 border-gray-300 dark:border-gray-800 text-gray-900 dark:text-gray-50 bg-white dark:bg-gray-950 hover:bg-gray-50 dark:hover:bg-gray-900/60 disabled:text-gray-400 disabled:dark:text-gray-600 ml-auto hidden gap-x-2 px-2 py-1.5 text-sm sm:text-xs lg:flex cursor-pointer" type="button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" aria-hidden="true" class="remixicon size-4"><path d="M5 7C5 6.17157 5.67157 5.5 6.5 5.5C7.32843 5.5 8 6.17157 8 7C8 7.82843 7.32843 8.5 6.5 8.5C5.67157 8.5 5 7.82843 5 7ZM6.5 3.5C4.567 3.5 3 5.067 3 7C3 8.933 4.567 10.5 6.5 10.5C8.433 10.5 10 8.933 10 7C10 5.067 8.433 3.5 6.5 3.5ZM12 8H20V6H12V8ZM16 17C16 16.1716 16.6716 15.5 17.5 15.5C18.3284 15.5 19 16.1716 19 17C19 17.8284 18.3284 18.5 17.5 18.5C16.6716 18.5 16 17.8284 16 17ZM17.5 13.5C15.567 13.5 14 15.067 14 17C14 18.933 15.567 20.5 17.5 20.5C19.433 20.5 21 18.933 21 17C21 15.067 19.433 13.5 17.5 13.5ZM4 16V18H12V16H4Z"></path></svg> Show Columns</button>

            <!-- Dropdown menu -->
            <div id="dropdownToggle" class="z-10 text-sm shadow-md border border-gray-200 dark:border-gray-800 text-gray-900 dark:text-gray-50 bg-gray-50 dark:bg-gray-950 divide-y divide-gray-100 rounded-lg shadow-sm w-72 dark:divide-gray-600 hidden">
                <ul class="p-2 space-y-1" aria-labelledby="dropdownToggleButton">
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.id" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">ID</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.name" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Name</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.description" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Description</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.ram" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Memory</span>
                            </label>
                        </div>
                    </li>

                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.cpu" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">CPU</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.disk_limit" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Disk (storage)</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.inodes_limit" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Inodes (files count)</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.bandwidth" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Port Speed</span>
                            </label>
                        </div>
                    </li>


                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.domains_limit" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Domains</span>
                            </label>
                        </div>
                    </li>


                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.websites_limit" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Websites</span>
                            </label>
                        </div>
                    </li>

                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.db_limit" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Databases (mysql+postgre)</span>
                            </label>
                        </div>
                    </li>

                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.email_limit" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Email accounts</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.ftp_limit" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">FTP accounts</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.feature_set" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Feature Set</span>
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="flex py-1 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-600">
                            <label class="inline-flex items-center w-full cursor-pointer">
                                <input type="checkbox" x-model="columns.user_count" x-on:change="saveColumns" class="sr-only peer">
                                <div class="relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full rtl:peer-checked:after:translate-x-[-100%] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div>
                                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Users using a plan</span>
                            </label>
                        </div>
                    </li>
                </ul>
            </div>
        </div>





                </div>
            </div>
            <div class="relative">
                <table class="w-full caption-bottom border-b border-gray-200 dark:border-gray-800" id="exiting_users">
                    <thead class="">
                        <tr class="[&amp;_td:last-child]:pr-4 [&amp;_th:last-child]:pr-4 [&amp;_td:first-child]:pl-4 [&amp;_th:first-child]:pl-4 border-y border-gray-200 dark:border-gray-800">



                            <th x-show="columns.id" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>ID</span>

                                </div>
                            </th>  


                            <th x-show="columns.name" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Name</span>

                                </div>
                            </th>   

                            <th x-show="columns.description" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Description</span>

                                </div>
                            </th>  

                            <th x-show="columns.ram" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Memory</span>

                                </div>
                            </th>
                            <th x-show="columns.cpu" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>CPU</span>

                                </div>
                            </th>
                            <th x-show="columns.disk_limit" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Disk</span>

                                </div>                                
                            </th>
                            <th x-show="columns.inodes_limit" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Inodes</span>

                                </div>                                
                            </th>
                            <th x-show="columns.bandwidth" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Port speed</span>

                                </div>                                
                            </th>
                            <th x-show="columns.domains_limit" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">                                
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Domains</span>

                                </div></th>
                            <th x-show="columns.websites_limit" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Websites</span>

                                </div>                                
                            </th>
                            <th x-show="columns.db_limit" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Databases</span>

                                </div>                                
                            </th>
                            <th x-show="columns.email_limit" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Email accounts</span>

                                </div>                                
                            </th>
                            <th x-show="columns.ftp_limit" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>FTP accounts</span>

                                </div>                                
                                </th>

                            <th x-show="columns.feature_set" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Feature Set</span>

                                </div>
                            </th>  

                            <th x-show="columns.user_count" class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-left">
                                <div class="-mx-2 inline-flex cursor-pointer select-none items-center gap-2 rounded-md px-2 py-1 hover:bg-gray-50 hover:dark:bg-gray-900">
                                    <span>Used by</span>
                                </div>
                            </th>  





                            <th class="border-b px-4 font-semibold text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 whitespace-nowrap py-1 text-sm sm:text-xs text-right">Edit</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 dark:divide-gray-800">

{% if mysql_is_down %}
<tr>
    <td colspan="13" class="p-6 text-center">
        MySQL service is not running.  <a href="/services" class="relative inline-flex items-center justify-center rounded-md border px-3 py-2 text-center text-sm font-medium shadow-sm transition-all duration-100 ease-in-out cursor-pointer outline outline-offset-2 outline-0 focus-visible:outline-2 outline-blue-500 dark:outline-blue-500 dark:border-gray-800 dark:text-gray-50 dark:bg-gray-950 dark:hover:bg-gray-900/60 disabled:text-gray-400 disabled:dark:text-gray-600 sm:w-fit border-black bg-black text-white hover:bg-gray-800 sm:mt-0">View service status</a>
    </td>
</tr>

{% elif plans %}


                {% for plan in plans %}
                
                        <tr x-show="searchQuery === '' || '{{ plan.name }}'.toLowerCase().includes(searchQuery.toLowerCase())" class="user-row [&_td:last-child]:pr-4 [&_th:last-child]:pr-4 [&_td:first-child]:pl-4 [&_th:first-child]:pl-4 group select-none hover:bg-gray-50 hover:dark:bg-gray-900">

                            <td x-show="columns.id" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400">{{ plan.id }}</td>

                            <td x-show="columns.name" class="p-4 text-sm relative whitespace-nowrap py-1 font-medium text-gray-900 dark:text-gray-50 first:w-10 text-left select-text">{{ plan.name}}</td>

                            <td x-show="columns.description" class="p-4 text-xs relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left select-text">{{ plan.description}}</td>

                            <td x-show="columns.ram" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left"><p class="m-0"><span class="icon icon-tabler"><i class="bi bi-memory"></i></span> {% if plan.ram == "0 g" or plan.ram == "0g" or plan.ram is none %}∞{% else %}{{ plan.ram.rstrip('g') }}{% endif %} GB</p></td>

                            <td x-show="columns.cpu" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left"><p class="m-0"><span class="icon icon-tabler"><i class="bi bi-cpu"></i></span> {% if plan.cpu == "0" or plan.cpu is none %}∞{% else %}{{ plan.cpu }}{% endif %} Core</p></td>

                            <td x-show="columns.disk_limit" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left"><p class="m-0"><span class="icon icon-tabler"><i class="bi bi-hdd"></i></span> {% if plan.disk_limit == "0 GB" %}∞{% else %}{{ plan.disk_limit }}{% endif %}</p></td>

                            <td x-show="columns.inodes_limit" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left">
                                        <p class="m-0"><span class="icon icon-tabler"><i class="bi bi-hdd-stack"></i></span> {% if plan.inodes_limit == "0" or plan.inodes_limit == 0 or plan.inodes_limit is none %}∞{% else %}{{ plan.inodes_limit }}{% endif %}</p></td>
                            <td x-show="columns.bandwidth" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left">
                            {% if plan.bandwidth == 0 %}∞{% else %}{{ plan.bandwidth }} mbits{% endif %}
                            </td>

                            <td x-show="columns.domains_limit" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left">
                              {% if plan.domains_limit == 0 %}∞{% else %}{{ plan.domains_limit }}{% endif %}
                              </td>
                            <td x-show="columns.websites_limit" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left">{% if plan.websites_limit == 0 %}∞{% else %}{{ plan.websites_limit }}{% endif %}</td>

                            <td x-show="columns.db_limit" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left">{% if plan.db_limit == 0 %}∞{% else %}{{ plan.db_limit }}{% endif %}</td>

                            <td x-show="columns.email_limit" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left">{% if plan.email_limit == 0 %}∞{% else %}{{ plan.email_limit }}{% endif %}</td>    

                            <td x-show="columns.ftp_limit" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left">{% if plan.ftp_limit == 0 %}∞{% else %}{{ plan.ftp_limit }}{% endif %}</td>

                            <td x-show="columns.feature_set" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left select-text"><a href="/features/{{ plan.feature_set }}">{{ plan.feature_set }}</a></td>


                            <td x-show="columns.user_count" class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-left">
                                {% if plan.user_count != 0 %}
                                    <a href="/users?plan={{plan.name}}">{{ plan.user_count }}</a>
                                {% else %}
                                    {{ plan.user_count }}
                                {% endif %}
                                </td>

                              <td class="p-4 text-sm relative whitespace-nowrap py-1 text-gray-600 first:w-10 dark:text-gray-400 text-right">
                              
<button id="{{ plan.id }}" data-dropdown-toggle="dropdown-{{ plan.id }}" class="relative inline-flex items-center justify-center whitespace-nowrap rounded-md border text-center text-sm font-medium transition-all duration-100 ease-in-out disabled:pointer-events-none disabled:shadow-none outline outline-offset-2 outline-0 focus-visible:outline-2 outline-indigo-500 dark:outline-indigo-500 shadow-none border-transparent text-gray-900 dark:text-gray-50 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800/80 disabled:text-gray-400 disabled:dark:text-gray-600 group aspect-square p-1.5 hover:border hover:border-gray-300 data-[state=open]:border-gray-300 data-[state=open]:bg-gray-50 hover:dark:border-gray-700 data-[state=open]:dark:border-gray-700 data-[state=open]:dark:bg-gray-900 cursor-pointer" type="button"> 
  <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 3">
    <path d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/>
  </svg>
</button>

<!-- Dropdown menu -->
<div id="dropdown-{{ plan.id }}" class="relative z-50 hidden rounded-md border p-1 shadow-xl shadow-black/[2.5%] max-h-[var(--radix-popper-available-height)] bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-50 border-gray-200 dark:border-gray-800 will-change-[transform,opacity] data-[state=closed]:animate-hide data-[side=bottom]:animate-slideDownAndFade data-[side=left]:animate-slideLeftAndFade data-[side=right]:animate-slideRightAndFade data-[side=top]:animate-slideUpAndFade min-w-40 text-left cursor-pointer">
    <ul class="py-2 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="{{ plan.id }}">
      <li class="flex">
          <a href="/plans/{{ plan.id }}" class="w-full group/DropdownMenuItem relative flex cursor-pointer select-none items-center rounded py-1.5 pl-2 pr-1 outline-none transition-colors data-[state=checked]:font-semibold sm:text-sm text-gray-900 dark:text-gray-50 data-[disabled]:pointer-events-none data-[disabled]:text-gray-400 data-[disabled]:hover:bg-none dark:data-[disabled]:text-gray-600 focus-visible:bg-gray-100 focus-visible:dark:bg-gray-900 hover:bg-gray-100 hover:dark:bg-gray-900">Edit</a>
        </form>
      </li>
      <li class="flex">

        {% if plan.user_count == 0 %}

          <form method="POST" class="w-full" action="/plan/delete/{{ plan.name }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="w-full group/DropdownMenuItem relative flex cursor-pointer select-none items-center rounded py-1.5 pl-2 pr-1 outline-none transition-colors data-[state=checked]:font-semibold sm:text-sm data-[disabled]:pointer-events-none data-[disabled]:text-gray-400 data-[disabled]:hover:bg-none dark:data-[disabled]:text-gray-600 focus-visible:bg-gray-100 focus-visible:dark:bg-gray-900 hover:bg-gray-100 hover:dark:bg-gray-900 text-red-600 dark:text-red-500">Delete</button>
        </form>

        {% endif %}

      </li>
    </ul>
</div>                              
                              
                              
                              </td>    




                                </tr>

                {% endfor %}


{% else %}

<tr>
    <td colspan="12" class="p-6 text-center">
        No plans yet. <a href="/plans/new" class="relative inline-flex items-center justify-center rounded-md border px-3 py-2 text-center text-sm font-medium shadow-sm transition-all duration-100 ease-in-out cursor-pointer outline outline-offset-2 outline-0 focus-visible:outline-2 outline-blue-500 dark:outline-blue-500 dark:border-gray-800 dark:text-gray-50 dark:bg-gray-950 dark:hover:bg-gray-900/60 disabled:text-gray-400 disabled:dark:text-gray-600 sm:w-fit border-black bg-black text-white hover:bg-gray-800 sm:mt-0">Create your first plan</a>
    </td>
</tr>

{% endif %}



                    </tbody>
                </table>
              

                <div class="fixed inset-x-0 bottom-8 mx-auto flex w-fit items-center"></div>
            </div>
            <div class="px-6 py-2 flex items-center justify-between">
                <div></div>
                <div class="hidden text-sm tabular-nums text-gray-500">0 of {{ plans|length }} row(s) selected.</div>
                <div class="flex items-center gap-x-6 lg:gap-x-8">
<p class="text-sm tabular-nums text-gray-500 sm:block">
  Showing 
  <span class="font-medium text-gray-900 dark:text-gray-50" x-text="count"></span> of <span class="font-medium text-gray-900 dark:text-gray-50">{{ plans|length }}</span>
</p>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
function plansTable() {
    return {
        searchQuery: '',
        columns: {
            id: false,
            bandwidth: true,
            cpu: true,
            db_limit: true,
            description: false,
            disk_limit: true,
            domains_limit: true,
            email_limit: true,
            feature_set: true,
            ftp_limit: true,
            inodes_limit: true,
            name: true,
            ram: true,
            websites_limit: true,
            user_count: true
        },
        count: {{ plans|length }},

        init() {
            this.loadColumns();
            this.initWatchers();
        },

        initWatchers() {
            this.$watch('searchQuery', () => {
                this.$nextTick(() => this.updateCount());
            });

            // Watch columns changes and save
            this.$watch('columns', () => {
                this.saveColumns();
            }, { deep: true });
        },

        updateCount() {
            // Count visible rows
            this.count = [...this.$refs.tbody.querySelectorAll('tr.user-row')]
                .filter(row => row.offsetParent !== null).length;
        },

        saveColumns() {
            localStorage.setItem('columnsVisibilityPlans', JSON.stringify(this.columns));
        },

        loadColumns() {
            const saved = localStorage.getItem('columnsVisibilityPlans');
            if (saved) {
                try {
                    this.columns = JSON.parse(saved);
                } catch (e) {
                    console.warn("Failed to parse columnsVisibilityPlans from localStorage", e);
                }
            }
        }
    };
}
</script>



{% endblock %}
