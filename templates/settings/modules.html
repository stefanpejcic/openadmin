<!-- templates/settings/modules.html -->
{% extends 'base.html' %}

{% block content %}


<form method="post">
<input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

<div x-data="{
    searchQuery: '',
    toggleAll: null,
    filterType: '',
    applyToAll(state) {
        this.toggleAll = state;
        document.querySelectorAll('[data-row]:not([data-locked])').forEach(el => {
            el.__x.$data.enabled = state;
        });
    },
    matchesFilter(type, category) {
        if (!this.filterType) return true;
        return this.filterType === type || (this.filterType === 'plugin' && category === 'plugin');
    }
}">



    <div x-data="{ showSection: false }" class="border-b border-gray-200 bg-gray-50 p-4 dark:border-gray-800 dark:bg-gray-950 sm:p-6 lg:p-8">
        <header>
            <div class="flex flex-col gap-2 text-center sm:flex-row sm:items-center sm:justify-between sm:text-start">
                <div class="grow">
                    <h1 class="mb-1 text-xl font-bold">Modules</h1>
                    <h2 class="text-sm font-medium text-slate-500">Enable/disable modules (options) for OpenPanel. <a href="https://openpanel.com/docs/admin/settings/modules/" target="_blank" class="hidden items-center gap-1 text-indigo-600 hover:underline hover:underline-offset-4 dark:text-indigo-400">Documentation<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" aria-hidden="true" class="remixicon size-4 shrink-0"><path d="M10 6V8H5V19H16V14H18V20C18 20.5523 17.5523 21 17 21H4C3.44772 21 3 20.5523 3 20V7C3 6.44772 3.44772 6 4 6H10ZM21 3V11H19L18.9999 6.413L11.2071 14.2071L9.79289 12.7929L17.5849 5H13V3H21Z"></path></svg></a></h2>
                </div>
               
                <div class="flex flex-col items-center justify-center gap-2 rounded-sm px-2 sm:justify-end sm:bg-transparent sm:px-0">
                  <button type="submit"
                  class="relative inline-flex items-center justify-center whitespace-nowrap rounded-md border px-3 py-2 text-center text-sm font-medium shadow-sm transition-all duration-100 ease-in-out disabled:pointer-events-none disabled:shadow-none outline outline-offset-2 outline-0 focus-visible:outline-2 outline-indigo-500 dark:outline-indigo-500 border-transparent text-white dark:text-gray-900 bg-indigo-600 dark:bg-indigo-500 hover:bg-indigo-500 dark:hover:bg-indigo-600 disabled:bg-indigo-100 disabled:text-gray-400 disabled:dark:bg-indigo-800 disabled:dark:text-indigo-400">Save Changes</button>
                </div>
            </div>
        </header>
    </div>




<div class="">
  <div class="space-y-3">
    <div class="px-6 py-3 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-x-6 border-b border-gray-200 dark:border-gray-800">
                <div class="flex w-full flex-col gap-2 sm:w-fit sm:flex-row sm:items-center">
                    <div class="relative w-full sm:max-w-[250px] sm:[&amp;>input]:h-[30px]">
    <input x-model="searchQuery"  class="relative block w-full appearance-none rounded-md border px-2.5 py-1.5 outline-none transition sm:text-sm border-transparent dark:border-gray-800 text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 bg-gray-100 dark:bg-gray-950 disabled:border-gray-300 disabled:bg-gray-100 disabled:text-gray-400 disabled:dark:border-gray-700 disabled:dark:bg-gray-800 disabled:dark:text-gray-500 focus:ring-2 focus:ring-indigo-200 focus:dark:ring-indigo-700/30 focus:border-indigo-500 focus:dark:border-indigo-700 [&amp;::--webkit-search-cancel-button]:hidden [&amp;::-webkit-search-cancel-button]:hidden [&amp;::-webkit-search-decoration]:hidden pl-8" placeholder="Search modules..." type="search" @input="searchQuery = $event.target.value.trim()">

                        <div class="pointer-events-none absolute bottom-0 left-2 flex h-full items-center justify-center text-gray-400 dark:text-gray-600">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" aria-hidden="true" class="remixicon size-[1.125rem] shrink-0">
                                <path
                                    d="M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.124 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20 13.124 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748Z"
                                ></path>
                            </svg>
                        </div>
                    </div>

<div class="flex flex-wrap gap-1 justify-center sm:justify-start">
  <button type="button"
    @click="filterType = ''"
    :class="filterType === '' ? 'bg-indigo-600 text-white' : 'bg-white text-gray-500 dark:bg-gray-800'"
    class="rounded-md border border-gray-200 dark:border-gray-700 px-2 py-1 text-xs font-medium transition"
  >
    All
  </button>
  <button type="button"
    @click="filterType = 'community'"
    :class="filterType === 'community' ? 'bg-indigo-600 text-white' : 'bg-white text-gray-500 dark:bg-gray-800'"
    class="rounded-md border border-gray-200 dark:border-gray-700 px-2 py-1 text-xs font-medium transition"
  >
    Community
  </button>
  <button type="button"
    @click="filterType = 'enterprise'"
    :class="filterType === 'enterprise' ? 'bg-indigo-600 text-white' : 'bg-white text-gray-500 dark:bg-gray-800'"
    class="rounded-md border border-gray-200 dark:border-gray-700 px-2 py-1 text-xs font-medium transition"
  >
    Enterprise
  </button>
  <button type="button"
    @click="filterType = 'beta'"
    :class="filterType === 'beta' ? 'bg-indigo-600 text-white' : 'bg-white text-gray-500 dark:bg-gray-800'"
    class="rounded-md border border-gray-200 dark:border-gray-700 px-2 py-1 text-xs font-medium transition"
  >
    BETA
  </button>
  <button type="button"
    @click="filterType = 'plugin'"
    :class="filterType === 'plugin' ? 'bg-indigo-600 text-white' : 'bg-white text-gray-500 dark:bg-gray-800'"
    class="rounded-md border border-gray-200 dark:border-gray-700 px-2 py-1 text-xs font-medium transition"
  >
    Plugins
  </button>
</div>



                </div>

<div class="flex flex-wrap gap-3 justify-center sm:justify-end">


<span class="inline-flex items-center gap-x-2.5 rounded-full bg-white px-2.5 py-1.5 text-xs ring-1 ring-inset ring-gray-200 dark:bg-gray-950 dark:ring-gray-800">
  <button
    type="button"
    @click="applyToAll(true)"
    class="inline-flex items-center gap-1.5 font-medium text-gray-900 dark:text-gray-50"
  ><svg class="remixicon -ml-0.5 size-4 shrink-0 text-emerald-600 dark:text-emerald-500" fill="currentColor" viewBox="0 0 24 24"><path d="M12 22C17.5 22 22 17.5 22 12S17.5 2 12 2 2 6.5 2 12s4.5 10 10 10Zm5.5-12.5-6.5 6.5-4.2-4.2L8.2 10.3l2.3 2.3 5.1-5.1 1.4 1.4Z"></path></svg>Enable All
  </button>

    <span class="h-4 w-px bg-gray-200 dark:bg-gray-800"></span>

  <button
    type="button"
    @click="applyToAll(false)"
    class="inline-flex items-center gap-1.5 font-medium text-gray-900 dark:text-gray-50"
  ><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" aria-hidden="true" class="remixicon -ml-0.5 size-4 shrink-0 text-red-600 dark:text-red-500"><path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z"></path></svg>Disable All
  </button>
</span>

</div>

    </div>

<div class="m-8">


<div class="grid grid-cols-1 gap-x-14 gap-y-8 md:grid-cols-3">


    <div class="md:col-span-3">


<div class="grid grid-cols-1 gap-4 md:grid-cols-3">

  {% for plugin in plugins %}

            <div x-data="{ enabled: {{ 'true' if plugin.status else 'false' }} }"
    x-effect="if (typeof toggleAll === 'boolean') enabled = toggleAll"
    data-row 
    class="relative w-full rounded-lg border text-left shadow-sm bg-white dark:bg-[#090E1A] border-gray-200 dark:border-gray-900 overflow-hidden p-0 flex flex-col h-full"
    x-show="(searchQuery === '' || '{{ plugin.title }}'.toLowerCase().includes(searchQuery.toLowerCase())) && matchesFilter('plugin', 'plugin')"  
    >
      <div class="px-4 pb-6 pt-4">
        <span class="text-sm text-gray-500">{{ plugin.link }}</span>
        <div class="flex items-center gap-2 mt-4">
          <h4 class="text-sm font-semibold text-gray-900 dark:text-gray-50">
            {{ plugin.name }}
          </h4>
            <span class="flex gap-2 rounded bg-orange-500 text-white dark:bg-orange-700 px-2 py-0.5 text-xs font-medium"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plugin" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M1 8a7 7 0 1 1 2.898 5.673c-.167-.121-.216-.406-.002-.62l1.8-1.8a3.5 3.5 0 0 0 4.572-.328l1.414-1.415a.5.5 0 0 0 0-.707l-.707-.707 1.559-1.563a.5.5 0 1 0-.708-.706l-1.559 1.562-1.414-1.414 1.56-1.562a.5.5 0 1 0-.707-.706l-1.56 1.56-.707-.706a.5.5 0 0 0-.707 0L5.318 5.975a3.5 3.5 0 0 0-.328 4.571l-1.8 1.8c-.58.58-.62 1.6.121 2.137A8 8 0 1 0 0 8a.5.5 0 0 0 1 0"/>
</svg> Plugin</span>
        </div>
        <p class="mt-2 max-w-xl text-sm leading-6 text-gray-500">{{ plugin.description }}</p>

        {% if plugin.version %}
        <p class="mt-2 max-w-xl text-sm leading-6 text-gray-500">Version: {{ plugin.version }}</p>
        {% endif %}

        {% if plugin.author %}
        <p class="mt-2 max-w-xl text-sm leading-6 text-gray-500">Author: {{ plugin.author }}</p>
        {% endif %}



      </div>
      <div class="flex items-center justify-between border-t border-gray-200 bg-gray-50 p-4 dark:border-gray-900 dark:bg-gray-900 mt-auto">
        <div class="flex items-center gap-3">
        <label class="text-sm leading-none text-gray-900 dark:text-gray-50" for="{{ plugin.name }}">Active</label>
        </div>


        {% if plugin.help_link %}
        <a href="{{ plugin.help_link }}" target="_blank" class="inline-flex items-center gap-1 text-sm text-indigo-600 dark:text-indigo-500">Learn more
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" aria-hidden="true" class="remixicon size-4 shrink-0">
            <path d="M16.0037 9.41421L7.39712 18.0208L5.98291 16.6066L14.5895 8H7.00373V6H18.0037V17H16.0037V9.41421Z"></path>
          </svg>
        </a>
        {% endif %}
      </div>
    </div>
  {% endfor %}



  {% for feature in features %}

    {% set type = feature.type|lower %}
    {% set is_enterprise = (type == "enterprise") %}
    {% set disable_toggle = is_enterprise and (license_type != "Enterprise") %}
    <div x-data="{ enabled: {{ 'true' if feature.status else 'false' }} }"
        x-effect="if (typeof toggleAll === 'boolean' && !$el.hasAttribute('data-locked')) enabled = toggleAll"
        data-row
        x-show="(searchQuery === '' || '{{ feature.title }}'.toLowerCase().includes(searchQuery.toLowerCase())) && matchesFilter('{{ type }}', 'feature')"  
        {% if disable_toggle %} data-locked="true" {% endif %}
        class="relative w-full rounded-lg border text-left shadow-sm bg-white dark:bg-[#090E1A] border-gray-200 dark:border-gray-900 overflow-hidden p-0 flex flex-col h-full">
      <div class="px-4 pb-6 pt-4">
        <span class="text-sm text-gray-500">{{ feature.link }}</span>
        <div class="flex items-center gap-2 mt-4">
          <h4 class="text-sm font-semibold text-gray-900 dark:text-gray-50">
            {{ feature.title }}
          </h4>


                {% if type == "beta" %}
<span class="inline-flex items-center whitespace-nowrap rounded-md px-2 py-1 text-xs ring-1 ring-inset bg-gray-50 ring-gray-500/30 dark:bg-gray-400/10 dark:ring-gray-400/20 gap-1.5 font-normal capitalize text-gray-700 dark:text-gray-300"><span class="size-2 shrink-0 bg-orange-500 dark:bg-orange-500" aria-hidden="true"></span>BETA</span>
                {% elif type == "enterprise" %}
                        {% if license_type == "Enterprise" %}
<span class="inline-flex items-center whitespace-nowrap rounded-md px-2 py-1 text-xs ring-1 ring-inset bg-gray-50 ring-gray-500/30 dark:bg-gray-400/10 dark:ring-gray-400/20 gap-1.5 font-normal capitalize text-gray-700 dark:text-gray-300"><span class="size-2 shrink-0 bg-blue-600 dark:bg-blue-400" aria-hidden="true"></span>Enterprise</span>
                        {% else %}
<span class="inline-flex items-center whitespace-nowrap rounded-md px-2 py-1 text-xs ring-1 ring-inset bg-gray-50 ring-gray-500/30 dark:bg-gray-400/10 dark:ring-gray-400/20 gap-1.5 font-normal capitalize text-gray-700 dark:text-gray-300"><span class="size-2 shrink-0 bg-red-500 dark:bg-red-500" aria-hidden="true"></span>Enterprise</span>
                        {% endif %}
                {% elif type == "community" %}
<span class="inline-flex items-center whitespace-nowrap rounded-md px-2 py-1 text-xs ring-1 ring-inset bg-gray-50 ring-gray-500/30 dark:bg-gray-400/10 dark:ring-gray-400/20 gap-1.5 font-normal capitalize text-gray-700 dark:text-gray-300"><span class="size-2 shrink-0 bg-emerald-600 dark:bg-emerald-400" aria-hidden="true"></span>Community</span>
                {% else %}
<span class="inline-flex items-center whitespace-nowrap rounded-md px-2 py-1 text-xs ring-1 ring-inset bg-gray-50 ring-gray-500/30 dark:bg-gray-400/10 dark:ring-gray-400/20 gap-1.5 font-normal capitalize text-gray-700 dark:text-gray-300"><span class="size-2 shrink-0 bg-gray-500 dark:bg-gray-500" aria-hidden="true"></span>{{ type }}</span>
                {% endif %}
        </div>
        <p class="mt-2 max-w-xl text-sm leading-6 text-gray-500">{{ feature.description }}</p>
      </div>
      <div class="flex items-center justify-between border-t border-gray-200 bg-gray-50 p-4 dark:border-gray-900 dark:bg-gray-900 mt-auto">

        <div class="flex items-center gap-3">


          <button type="button" @click="enabled = !enabled" :aria-checked="enabled"
            :class="enabled ? 'bg-indigo-600' : 'bg-gray-200 dark:bg-gray-950'"
            class="inline-flex h-5 w-9 items-center rounded-full p-0.5 transition ring-1 ring-inset ring-black/5 dark:ring-gray-800 focus:outline-none"
            {% if disable_toggle %} disabled aria-disabled="true"
            class="opacity-50 cursor-not-allowed {{ 'bg-indigo-300 dark:bg-indigo-900' if feature.status else 'bg-gray-100 dark:bg-gray-800' }}"
            {% endif %}>
            <span :class="enabled ? 'translate-x-4' : 'translate-x-0'"
              class="h-4 w-4 transform rounded-full bg-white dark:bg-gray-50 transition"></span>
          </button>
          <input type="checkbox" x-model="enabled" hidden name="{{ feature.name }}" value="{{ feature.name }}"
            :checked="enabled">
        {% if not disable_toggle %}
        <label class="text-sm leading-none text-gray-900 dark:text-gray-50" for="{{ feature.name }}">Activate</label>
        {% endif %}
        </div>


        {% if feature.help_link %}
        <a href="{{ feature.help_link }}" target="_blank" class="inline-flex items-center gap-1 text-sm text-indigo-600 dark:text-indigo-500">Learn more
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" aria-hidden="true" class="remixicon size-4 shrink-0">
            <path d="M16.0037 9.41421L7.39712 18.0208L5.98291 16.6066L14.5895 8H7.00373V6H18.0037V17H16.0037V9.41421Z"></path>
          </svg>
        </a>
        {% endif %}
      </div>
    </div>
  {% endfor %}

</div>


        <div class="col-span-full mt-6 flex justify-end"></div>
    </div>
</div>

</div>

</div>

</form>
{% endblock %}
