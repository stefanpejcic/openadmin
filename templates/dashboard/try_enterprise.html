<style>
    .dismiss-custom_message-button {
        display: none;
    }
    #custom_message:hover .dismiss-custom_message-button {
        display: inline-block;
    }
</style>



<dl id="custom_message">
    <div class="">

        <div class="p-6 flex flex-col gap-2 text-center sm:flex-row sm:items-center sm:justify-between sm:text-start border-b border-gray-200 px-6 dark:border-gray-900">

<div class="flex justify-between items-center w-full gap-4">
    <form action="{{ url_for('dismiss_dashboard_widget', template_name='try_enterprise') }}" method="post" class="flex-1">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div>
            <h3 class="font-medium text-gray-900 dark:text-gray-50">
                Try Enterprise 
                <button class="dismiss-custom_message-button text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded px-2 py-1 ml-2" type="submit">
                    Dismiss
                </button>
            </h3>
            <p class="text-sm/6 text-gray-500 dark:text-gray-500" id="pricing-container"></p>
        </div>
    </form>
    <a href="/license" id="purchaselink" class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm whitespace-nowrap">
        Upgrade
    </a>
</div>

            </div>

                <div class="flex flex-1 flex-col gap-2 overflow-y-auto  [&::-webkit-scrollbar]:w-2  [&::-webkit-scrollbar-track]:bg-gray-100  [&::-webkit-scrollbar-thumb]:bg-gray-300  dark:[&::-webkit-scrollbar-track]:bg-neutral-700  dark:[&::-webkit-scrollbar-thumb]:bg-neutral-500">
                    <div class="divide-y divide-gray-200 dark:divide-gray-800 mt-4" id="features-container"></div>
                </div>

    </div>
</dl>

<script>
$(document).ready(function() {
    $.ajax({
        url: 'https://api.openpanel.com/whmcs.php',
        method: 'GET',
        dataType: 'json',
        success: function(response) {
            if (response.result === 'success' && response.totalresults > 0) {
                const product = response.products.product[0];
                const pricing = product.pricing.EUR;
                
                $('#pricing-container').html(`Starting at ${pricing.monthly} ${pricing.suffix} monthly`);
                $('#purchaselink').attr('href', product.product_url);
                
                const featureListMatch = product.description.match(/<ul>(.*?)<\/ul>/s);
                if (featureListMatch) {
                    const features = featureListMatch[1].match(/<li>(.*?)<\/li>/g).map(item => item.replace(/<li>|<\/li>/g, '').trim());
                    const featuresContainer = $('#features-container');
                    featuresContainer.empty();
                    
                    features.forEach(feature => {
                        featuresContainer.append(`
                            <div class="flex items-center gap-2 py-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 12l5 5L20 7" />
                                </svg>
                                <span>${feature}</span>
                            </div>
                        `);
                    });
                } else {
                    $('#features-container').html('<p class="text-gray-500">No features found.</p>');
                }
            } else {
                $('#pricing-container').html('<p class="text-gray-500">No products found.</p>');
            }
        },
        error: function(xhr, status, error) {
            console.error('AJAX Error:', status, error);
            console.error('Response:', xhr.responseText);
            $('#pricing-container').html('<p class="text-red-500">Error retrieving pricing information.</p>');
        }
    });
});
</script>
